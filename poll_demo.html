<!DOCTYPE html>
<html>
<head>
    <title>Live Poll Demo</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f8fafc; }
        #poll { width: 400px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #ccc; padding: 24px; }
        #votes { margin-bottom: 16px; font-size: 18px; color: #333; }
        .option { margin: 8px 0; }
        button { padding: 8px 16px; border-radius: 4px; background: #4F8EF7; color: #fff; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div id="poll">
        <h2>Live Poll</h2>
        <div id="votes">No votes yet.</div>
        <div class="option"><button onclick="vote('A')">Vote A</button></div>
        <div class="option"><button onclick="vote('B')">Vote B</button></div>
        <div class="option"><button onclick="vote('C')">Vote C</button></div>
    </div>
    <script>
        const ws = new WebSocket('ws://127.0.0.1:8000/ws/poll/');
        const votes = {A: 0, B: 0, C: 0};
        const votesDiv = document.getElementById('votes');

        ws.onmessage = function(event) {
            let data;
            try { data = JSON.parse(event.data); } catch { return; }
            if (data.vote) {
                votes[data.vote] = (votes[data.vote] || 0) + 1;
                updateVotes();
            }
        };

        function vote(option) {
            ws.send(JSON.stringify({vote: option}));
        }

        function updateVotes() {
            votesDiv.textContent = `A: ${votes.A} | B: ${votes.B} | C: ${votes.C}`;
        }
    </script>
</body>
</html>
